# 训练日志解读：tqdm 进度条

## 日志格式示例

```
learner:   1%|▊                                                            | 12804/1000000 [09:53<12:21:42, 22.18it/s]
```

## 各部分详细解释

### 1. `learner:`
- **含义**：进度条描述符（description）
- **来源**：`tqdm.tqdm(..., desc="learner")`
- **作用**：标识这是 Learner 进程的训练进度条

### 2. `1%`
- **含义**：完成百分比
- **计算**：`(当前步数 / 总步数) × 100% = (12804 / 1000000) × 100% ≈ 1.28%`
- **显示**：四舍五入显示为 `1%`

### 3. `|▊`
- **含义**：进度条可视化
- **格式**：`|`（开始）+ `▊`（已完成的块）+ 空白（未完成部分）
- **说明**：
  - `|`：进度条左边界
  - `▊`：已完成的进度块（根据百分比显示）
  - 空白：未完成部分
  - 由于只有 1%，所以只显示一个块

### 4. `12804/1000000`
- **含义**：当前步数 / 总步数
- **当前步数**：`12804` - 已完成的训练步数
- **总步数**：`1000000` - 配置的最大训练步数（`config.max_steps`）
- **说明**：这是 Learner 的训练步数，不是 Actor 的步数

### 5. `[09:53<12:21:42, 22.18it/s]`
- **含义**：时间统计信息
- **格式**：`[已用时间<预计剩余时间, 速度]`

#### 5.1 `09:53`
- **含义**：已用时间（elapsed time）
- **格式**：`[小时:分钟:秒]` 或 `[分钟:秒]`（如果小于1小时）
- **值**：9 分 53 秒
- **计算**：从训练开始到现在经过的时间

#### 5.2 `<12:21:42`
- **含义**：预计剩余时间（estimated remaining time）
- **格式**：`<[小时:分钟:秒]`
- **值**：12 小时 21 分 42 秒
- **计算**：`(总步数 - 当前步数) / 速度 = (1000000 - 12804) / 22.18 ≈ 12:21:42`
- **说明**：基于当前速度估算的剩余时间

#### 5.3 `22.18it/s`
- **含义**：训练速度（iterations per second）
- **单位**：每秒迭代次数
- **值**：22.18 次/秒
- **计算**：`当前步数 / 已用时间 = 12804 / (9×60 + 53) ≈ 22.18`
- **说明**：
  - 这是 Learner 的训练速度
  - 每次迭代包括：
    - 多次 Critic 更新（`cta_ratio - 1` 次）
    - 一次 Critic + Actor 更新
    - 数据采样和 GPU 计算

## 完整示例解读

```
learner:   1%|▊                                                            | 12804/1000000 [09:53<12:21:42, 22.18it/s]
```

**完整含义**：
- 这是 Learner 进程的训练进度
- 已完成 1% 的训练（12804 / 1000000 步）
- 已用时 9 分 53 秒
- 预计还需 12 小时 21 分 42 秒完成
- 当前训练速度为 22.18 步/秒

## 相关配置

### 训练步数配置

```python
# examples/experiments/config.py
class DefaultTrainingConfig:
    max_steps: int = 1000000  # 最大训练步数
```

### 训练速度影响因素

1. **GPU 性能**：JAX/JAXlib 在 GPU 上的计算速度
2. **批次大小**：`batch_size = 256`
3. **Critic/Actor 更新比例**：`cta_ratio = 2`（1 次 Critic + 1 次 Critic+Actor）
4. **数据采样速度**：从缓冲区采样数据的速度
5. **网络传输**：Actor 和 Learner 之间的数据传输（如果分布式部署）

### 典型训练速度

- **单 GPU（RTX 3090）**：15-25 it/s
- **多 GPU**：可能更快，取决于并行策略
- **CPU 训练**：1-5 it/s（不推荐）

## 进度条更新频率

进度条会实时更新，每次训练迭代后更新一次。

## 其他进度条示例

### Actor 进度条

```
actor:  45%|████████████████████████████████▌                              | 45000/100000 [05:23<06:32, 140.23it/s]
```

**含义**：
- Actor 进程的进度
- 已完成 45%（45000 / 100000 步）
- 已用时 5 分 23 秒
- 预计还需 6 分 32 秒
- 速度：140.23 步/秒（Actor 通常比 Learner 快，因为只做推理）

### 缓冲区填充进度条

```
Filling up replay buffer: 100%|████████████████████████████████| 100/100 [00:15<00:00,  6.67it/s]
```

**含义**：
- 等待 replay_buffer 填充到 `training_starts` 大小
- 已完成 100%（100 / 100 个样本）
- 已用时 15 秒
- 速度：6.67 样本/秒

## 监控建议

### 关键指标

1. **训练速度**（`it/s`）：
   - 正常范围：15-30 it/s（单 GPU）
   - 如果低于 10 it/s，可能有问题（GPU 未充分利用、数据加载慢等）

2. **预计剩余时间**：
   - 用于估算训练完成时间
   - 会随着训练速度变化而调整

3. **完成百分比**：
   - 用于跟踪训练进度
   - 结合检查点保存周期，可以估算保存频率

### 异常情况

1. **速度突然下降**：
   - 可能原因：GPU 内存不足、数据加载瓶颈、网络延迟
   - 检查：GPU 使用率、内存使用、网络状态

2. **预计剩余时间异常**：
   - 如果训练速度变化，预计时间会重新计算
   - 初期估算可能不准确，训练稳定后更准确

3. **进度条不更新**：
   - 可能原因：训练卡住、GPU 死锁、网络断开
   - 检查：日志输出、GPU 状态、网络连接

## 总结

这行日志提供了 Learner 训练过程的完整信息：
- ✅ 当前进度（百分比和步数）
- ✅ 时间统计（已用时间和预计剩余时间）
- ✅ 训练速度（每秒迭代次数）

通过这些信息，可以：
- 跟踪训练进度
- 估算训练完成时间
- 监控训练性能
- 发现潜在问题

